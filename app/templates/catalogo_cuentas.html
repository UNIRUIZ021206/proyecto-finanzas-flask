{% extends "base.html" %}

{% block title %}
<title>Catálogo de Cuentas</title>
<link rel="stylesheet" href="{{ url_for('static', filename='catalogo.css') }}">
{% endblock %}

{% block content %}
<h2 class="main-title">Gestión del Catálogo de Cuentas</h2>
<p class="main-subtitle">Añade o edita las cuentas contables del sistema.</p>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="flash-{{ category }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}

<form method="POST" action="{{ url_for('admin.catalogo_cuentas') }}" class="card" style="margin-bottom: 30px;">
    <h3>Añadir Nueva Cuenta</h3>
    <div class="form-grid">
        <input type="text" name="cuenta_id" placeholder="Código (ej: 1101)" required>
        <input type="text" name="nombre_cuenta" placeholder="Nombre (ej: Caja General)" required>
        
        <select name="tipo_cuenta" required>
            <option value="" disabled selected>Tipo de Cuenta...</option>
            <option value="Activo">Activo</option>
            <option value="Pasivo">Pasivo</option>
            <option value="Patrimonio">Patrimonio</option>
            <option value="Ingreso">Ingreso</option>
            <option value="Costo">Costo</option>
            <option value="Gasto">Gasto</option>
        </select>
        
        <select name="subtipo_cuenta" required>
            <option value="" disabled selected>SubTipo de Cuenta...</option>
            <optgroup label="Balance General">
                <option value="Activo Corriente">Activo Corriente</option>
                <option value="Activo No Corriente">Activo No Corriente</option>
                <option value="Pasivo Corriente">Pasivo Corriente</option>
                <option value="Pasivo No Corriente">Pasivo No Corriente</option>
                <option value="Patrimonio">Patrimonio</option>
            </optgroup>
            <optgroup label="Estado de Resultados">
                <option value="Ingreso">Ingreso</option>
                <option value="Costo">Costo</option>
                <option value="Gasto">Gasto</option>
            </optgroup>
        </select>
        
        <button type="submit">Agregar Cuenta</button>
    </div>
</form>

<h2 class="main-title" style="font-size: 1.8em; margin-top: 40px;">Cuentas Existentes</h2>
<table class="cuentas-tabla">
    <thead>
        <tr>
            <th>Código</th>
            <th>Nombre de Cuenta</th>
            <th>Tipo de Cuenta</th>
            <th>SubTipo de Cuenta</th>
        </tr>
    </thead>
    <tbody>
        {% for cuenta in cuentas %}
        <tr>
            <td>{{ cuenta[0] }}</td> <td>{{ cuenta[1] }}</td> <td>{{ cuenta[2] }}</td> <td>{{ cuenta[3] }}</td> </tr>
        {% else %}
        <tr>
            <td colspan="4" style="text-align: center;">No hay cuentas registradas.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}